# 交互式调整指南 - Interactive Adjustment Guide

## 🎯 解决方案：让裁剪位置可控！

我们新增了3个交互辅助节点，让您在ComfyUI中也能方便地调整裁剪位置和大小，无需反复猜测参数！

---

## 🆕 新增节点

### 1. 🔍 交互式预览节点

**作用**: 生成带参考线、网格、安全区的预览图，让您直观看到当前裁剪效果

**特点**:
- ✅ 红圈标记：显示最终裁剪边界
- ✅ 蓝圈安全区：建议主体内容保持在此范围内
- ✅ 绿色十字线：中心参考线
- ✅ 可选网格：帮助精确定位
- ✅ 参数提示：实时显示当前参数和调整建议

**输出**:
- 预览图：带所有参考线的效果图
- 参数提示：文字说明当前设置

---

### 2. 🎮 参数微调节点

**作用**: 通过下拉菜单快速调整参数，无需手动计算数值

**便捷操作**:
- 缩放调整：放大/缩小 5%或10%，一键重置
- 左右移动：左移/右移 10或50像素
- 上下移动：上移/下移 10或50像素

**输出**:
- 新的缩放、偏移X、偏移Y参数
- 变化说明：清楚显示参数如何变化

---

### 3. 👁️ 可视化引导裁剪节点

**作用**: 一站式节点！同时输出裁剪结果和预览图

**优势**:
- ✅ 一个节点替代两个
- ✅ 同时看到最终效果和调整参考
- ✅ 参数信息一目了然
- ✅ 最适合新手使用

---

## 📝 推荐工作流

### 方案A：最简单（推荐新手）

```
[Load Image] 
    → [可视化引导裁剪] (调整参数，看预览图)
    → [Save Image]
```

**说明**:
- 调整参数后，立即看到预览图效果
- 预览图显示红圈（裁剪边界）和蓝圈（安全区）
- 确认满意后，使用"裁剪结果"输出保存

---

### 方案B：精确控制（推荐进阶用户）

```
[Load Image] 
    ↓
[自动优化徽章参数] → 获得初始参数
    ↓
[参数微调] → 通过下拉菜单调整
    ↓                    ↓
[圆形徽章裁剪] ←──(连接新参数)
    ↓
[Save Image]
```

**说明**:
1. 自动优化给出最佳初始值
2. 参数微调节点快速调整（如"右移10"、"放大5%"）
3. 不满意就继续调整，满意就保存

---

### 方案C：完整预览流程

```
[Load Image] 
    ↓
┌─────────────────┐
│ [交互式预览]    │→ 查看预览图
│  - scale: 1.2   │→ 阅读参数提示
│  - offset_x: 20 │
│  - offset_y: -10│
└─────────────────┘
    ↓ (满意后使用相同参数)
[圆形徽章裁剪]
    ↓
[Save Image]
```

**说明**:
- 先用交互式预览节点看效果
- 在预览节点上反复调整参数
- 确认满意后，将相同参数复制到裁剪节点

---

## 🎨 预览图说明

### 预览图中的标记

```
┌─────────────────────┐
│   灰色背景区域      │
│                     │
│   ┌──🟢──┐         │ 🟢 绿色十字线 = 中心参考
│   │  🔵  │         │ 🔵 蓝色虚线圈 = 安全区(90%)
│   🟢 🔴 🟢         │ 🔴 红色实线圈 = 裁剪边界
│   │  🔵  │         │ ⬜ 灰色网格 = 位置参考
│   └──🟢──┘         │
│                     │
└─────────────────────┘
```

### 如何看预览图？

1. **主体内容应该在哪里？**
   - 重要内容：保持在🔵蓝色圈内（安全区）
   - 次要内容：可以在蓝圈外、红圈内
   - 红圈外：会被裁剪掉

2. **图片太小/太大？**
   - 太小：增大scale参数（如1.2、1.5）
   - 太大：减小scale参数（如0.8、0.6）

3. **位置偏了？**
   - 偏左：增大offset_x（正值向右）
   - 偏右：减小offset_x（负值向左）
   - 偏上：增大offset_y（正值向下）
   - 偏下：减小offset_y（负值向上）

---

## 💡 实用技巧

### 技巧1：使用可视化引导节点快速试错

```
试错流程:
1. 添加[可视化引导裁剪]节点
2. 调整参数 → 看预览图
3. 不满意 → 继续调整
4. 满意 → 保存"裁剪结果"
```

### 技巧2：用参数微调节点做小幅调整

```
常见场景:
- "图片稍微偏左了" → 选择"右移10"
- "图片有点小" → 选择"放大5%"
- "需要微调" → 重复选择小步长调整
```

### 技巧3：分两步走

```
第1步: 用自动优化 → 获得基础参数
第2步: 用参数微调 → 精细调整
```

### 技巧4：参数记录

```
在预览图的"参数提示"中会显示当前所有参数
可以截图保存，方便批量处理时复用
```

---

## 📊 参数调整速查表

| 想要效果 | 调整方法 | 微调选项 |
|---------|---------|---------|
| 图片放大 | 增大scale | "放大5%" / "放大10%" |
| 图片缩小 | 减小scale | "缩小5%" / "缩小10%" |
| 向右移动 | 增大offset_x | "右移10" / "右移50" |
| 向左移动 | 减小offset_x | "左移10" / "左移50" |
| 向下移动 | 增大offset_y | "下移10" / "下移50" |
| 向上移动 | 减小offset_y | "上移10" / "上移50" |
| 恢复默认 | 重置参数 | "重置为1.0" / "重置为0" |

---

## 🎯 实战示例

### 示例1：人物头像居中

**问题**: 导入头像后，人脸偏左上角

**解决步骤**:
```
1. 添加[可视化引导裁剪]节点
2. 观察预览图 → 发现人脸在红圈左上方
3. 调整参数:
   - offset_x: 50 (向右移50px)
   - offset_y: 30 (向下移30px)
   - scale: 1.3 (稍微放大)
4. 检查预览 → 人脸居中且在蓝色安全区内
5. 保存结果 ✓
```

---

### 示例2：Logo图标制作

**问题**: Logo图标周围有很多空白，想要填满圆形

**解决步骤**:
```
1. 添加[自动优化徽章参数]节点 → 得到scale=2.5
2. 添加[可视化引导裁剪]节点，使用scale=2.5
3. 观察预览图 → Logo填满圆形，但有点偏上
4. 调整offset_y: 20 (向下移)
5. 确认满意，保存 ✓
```

---

### 示例3：批量处理相似图片

**问题**: 有10张构图相似的照片需要处理

**解决步骤**:
```
1. 选一张代表图，用[可视化引导裁剪]调整参数
2. 记录最终参数: scale=1.2, offset_x=0, offset_y=-20
3. 对剩余9张图片:
   - 直接用[圆形徽章裁剪]节点
   - 使用相同参数
   - 批量处理完成 ✓
```

---

## 🆚 对比：改进前 vs 改进后

### 改进前 ❌
```
问题:
- 不知道参数应该设置多少
- 需要反复试错和重新执行
- 看不到裁剪边界在哪里
- 位置调整全凭猜测
```

### 改进后 ✅
```
优势:
- 预览图清晰显示裁剪边界
- 参数微调节点快速调整
- 安全区提示避免主体被裁
- 一边调整一边看效果
- 下拉菜单选择，无需计算
```

---

## 🎓 学习路径

### 第1天：熟悉可视化引导节点
```
目标: 能够独立调整一张图片
练习: 导入一张图片，调整到满意为止
```

### 第2天：掌握参数微调
```
目标: 理解各个调整选项的效果
练习: 尝试所有微调选项，观察变化
```

### 第3天：组合使用
```
目标: 建立高效工作流
练习: 自动优化 → 微调 → 预览 → 保存
```

---

## ❓ 常见问题

### Q1: 预览图和最终结果不一致？

**A**: 确保预览节点和裁剪节点使用相同的参数值（diameter_mm, scale, offset_x, offset_y, dpi）

---

### Q2: 参数微调节点的输出怎么连接？

**A**: 
```
[参数微调]
  → 新缩放 → 连接到 [圆形徽章裁剪] 的 scale
  → 新偏移X → 连接到 offset_x
  → 新偏移Y → 连接到 offset_y
```

---

### Q3: 能否进一步增加调整精度？

**A**: 可以！调整方法：
- 多次使用参数微调节点（如连续"右移10"三次 = 右移30）
- 或直接手动输入精确数值

---

### Q4: 预览图太小/太大？

**A**: 预览图大小是圆形直径的1.5倍，会根据diameter_mm和dpi自动调整。如需更改，可修改节点代码中的 `preview_size = int(circle_diameter_px * 1.5)`

---

## 🎉 总结

通过这3个新节点，您现在可以：

✅ **看得见** - 交互式预览显示裁剪边界和安全区  
✅ **调得准** - 参数微调提供便捷的增量调整  
✅ **用得爽** - 可视化引导一站式完成调整和裁剪

**不再需要反复猜测参数值！**

---

**祝您使用愉快！如有问题，欢迎反馈。** 😊

